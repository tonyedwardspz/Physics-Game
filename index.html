<!DOCTYPE html>
<html>
<head>

	<title>Physics Game</title>
	
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <script type="text/javascript" src="matter-0.8.0.js" /></script>
    
    <style>
    
        .button {
            height:20;
            width: 30;
            display: inline-block;
        }
    
    
    
    </style>
    
    
    <script>
        
        var Engine = Matter.Engine,
            World = Matter.World,
            Bodies = Matter.Bodies,
            Constraint = Matter.Constraint,
            Composites = Matter.Composites,
            MouseConstraint = Matter.MouseConstraint,
            Events = Matter.Events;           
            
         window.addEventListener('load', init);
        
        // Level Select
        var level = 1;
        
        function levelChange (){
             level = document.getElementById('levelSelect');
            
            //restart game
            init();
        }
        
        
        function init() {
            
            
            
            // Engine options
            var gameCanvas = document.getElementById('canvasContainer');
            var options = {
                    render: {
                    options: {
                        background: 'images/background.png',
                        wireframes: false,
                        width: 1000,
                    }}};
            
            
            var engine = Engine.create(gameCanvas, options);
        
            var mouse = MouseConstraint.create(engine, {
                constraint: { stiffness: 1 }
            });

            var ground = Bodies.rectangle(500, 600, 1000, 50, { 
                isStatic: true,
                render: {
                    visible: false
                }
            });
            
            var rockOptions = {
                render: {
                    sprite: {
                        texture: 'images/turnip.png'
                    }
                }
            };
            
            var ground2 = Bodies.rectangle(610, 250, 200, 20, { 
                isStatic: true,
                render: {
                    fillStyle: '#edc51e', 
                    strokeStyle: '#b5a91c'
                }
            });
            
            var rock = Bodies.polygon(170, 450, 8, 20, rockOptions);
            
            var anchor = { x:170, y:450 };
            
            var elastic = Constraint.create({
                pointA:anchor, 
                bodyB:rock, 
                stiffness: 0.1,
                render: {
                    lineWidth: 5,
                    strokeStyle: '#dfa417'
                }
            });

            var pyramid = Composites.pyramid(550, 300, 13, 10, 0, 0, function(x, y, column, row){
                var texture = column % 2 === 0 ? 'images/block.png' : 'images/block-2.png';
                return Bodies.rectangle(x, y, 25, 40, { 
                    render: { 
                        sprite: { 
                            texture: texture 
                        } 
                    } 
                }); 
            });
            
            
            var pyramid2 = Composites.pyramid(500, 0, 5, 10, 0, 0, function(x, y, column, row){
                var texture = column % 2 === 0 ? 'images/block.png' : 'images/block-2.png';
                return Bodies.rectangle(x, y, 25, 40, { 
                    render: { 
                        sprite: { 
                            texture: texture 
                        } 
                    } 
                }); 
            });
            
            
            if (level == 1){
                World.add(engine.world, [mouse, ground, pyramid, ground2, pyramid2, rock, elastic]);
            }else if (level == 2){
                World.add(engine.world, [mouse, ground, pyramid, rock, elastic]);
            }
            
            Events.on(engine, 'tick', function(event) {
                if(engine.input.mouse.button === -1 && rock.position.x > 190) {
                    rock = Bodies.polygon(170, 450, 7, 20, rockOptions);
                    World.add(engine.world, rock);
                    elastic.bodyB = rock;
                }
            });

            Engine.run(engine);  
        }

    </script>

</head>

<body>

    <div>
    
        
    
    </div>
    <div id="canvasContainer"></div>
    
</body>

</html>